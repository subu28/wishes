<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div id="viddiv">
    <video id="vid" src="./amazongift.mp4"></video>
    <div id="button">
      <svg width="130px" height="130px" viewBox="0 0 24 24" id="_24x24_On_Light_Play" data-name="24x24/On Light/Play" xmlns="http://www.w3.org/2000/svg">
        <rect id="view-box" width="24" height="24" fill="none"/>
        <path id="Shape" d="M0,9.75A9.75,9.75,0,1,1,9.75,19.5,9.761,9.761,0,0,1,0,9.75Zm1.5,0A8.25,8.25,0,1,0,9.75,1.5,8.259,8.259,0,0,0,1.5,9.75Zm5.75-3.8,7,3.8-7,3.8Z" transform="translate(2.25 2.25)" fill="#ffffff"/>
      </svg>
    </div>
    <div id="codesend">
      <span id="mailbutton">click here to get your code.</span>
      <br>
      <br>
      Your code will be sent to your we.*****@gmail.com mail id
    </div>
  </div>

</body>
<script>
  var vid = document.getElementById('vid');
  var button = document.getElementById('button');
  var codesend = document.getElementById('codesend');
  var mailbutton = document.getElementById('mailbutton');
  button.addEventListener('click', function() {
    if(vid.paused) {
      vid.play();
      button.style.opacity = 0;
    }
    vid.onended = function() {
      button.style.opacity = 1;
      codesend.style.opacity = 1;
    }
  });
  mailbutton.addEventListener('click', async function() {
    mailbutton.innerHTML = 'Sending code...';
    try {
      (await fetch('https://yemqzae909.execute-api.us-west-2.amazonaws.com/default/sendwish')).json().then(data => {
        if (data.status === 'success') {
          mailbutton.innerHTML = 'Code sent successfully';
        } else {
          mailbutton.innerHTML = 'Code sending failed';
        }
      });
    } catch (e) {
      mailbutton.innerHTML = 'Code sending failed';
    }
  });
</script>
</html>